# 웹사이트에 접속하는 과정



### 1. 목적지 ip 주소 확인

- 도메인 주소가 입력되면 해당 목적지의 ip 주소를 먼저 찾아야한다.

  DNS에 ip 주소를 요청하기 앞서, 브라우저의 캐시 파일이나 로컬의 hosts 파일을 확인한다.

  참조할 수 있는 데이터가 있다면 그 주소를 사용, 없으면 DNS로 부터 ip주소를 응답 받는다.



### 2. DHCP(Dynamic Host Configuration Protocol)

- 클라이언트 PC는 자신의 ip주소도 모르는 상황으로, udp 더미 패킷을 브로드캐스트 하여 DHCP 서버로부터 DHCP 서버의 ip주소, Lifetime 등을 포함한 정보를 수신하고 최적의 서버를 고르게 된다.

> DHCP 서버는 광역 패킷에서 port로 구분된다. 예를 들면 port 67은 DHCP 서버만 열고, 나머지는 다 닫아서 DHCP 서버가 아닌 노드는 패킷을 무시한다.

- 클라이언트 PC는 선택한 DHCP 서버로부터 자신의 ip주소, 가장 가까운 라우터 ip주소 등의 정보를 얻게 된다.
- 클라이언트 PC는 이제 자신의 ip주소, 목적지 ip주소, 가장 가까운 라우터 ip주소를 알게 된다.



### 3. ARP(Address Resolution Rotocol)

- 가장 가까운 Router의 ip주소를 알고 있는 상황에서 MAC 주소를 알아야 한다. 찾고자 하는 라우터의 ip 주소를 포함한 광역 패킷을 브로드캐스트 하고 호스트들은 자신의 ip 주소와 동일한지 확인하여 일치한다면 자신의 MAC 주소를 응답한다.



### 4. Framing과 Error Control

- A에서 X에게 보내고자 하는 데이터는 010001100101과 같은 비트들의 연속일 것이다. 이 연속되는 비트 열을 X가 받으면, 어디부터 A가 보낸 데이터이고 어디까지가 의미를 갖는지 알 수 없을 것이다.

  Framing은 패킷의 시작과 끝 부분에 식별 비트열을 배치시키는 과정, 또는 반대로 식별자를 읽어 프레임 단위로 비트열을 처리하는 과정을 말한다.

  이 과정에서 송신 측(A)은 에러 검출을 위한 필드(FCS)를 삽입한다. 수신 측(X)이 데이터를 읽었을 때 에러가 있는지 확인하여 에러를 직접 수정하거나, 폐기 후 재송신을 요청할 수 있도록 하기 위함이다.



### 5. Flow Control과 Congestion Control

- 데이터가 잘 전달되려면 송신 측만 데이터를 잘 가공해서 보낸다고 끝이 아니다. 앞서 Framing 에서 수신 측을 생각하여, FCS 필드를 추가해준 것처럼 수신 측의 처리 속도나, 네트워크 상황을 고려하여 송신해야 한다.
- 송신 측의 송신 속도보다 수신 측의 데이터 처리 속도가 느린 경우, 또는 수신 측에서 수신해야하는 다른 데이터가 너무 많은 경우 등의 이유로 수신 측의 버퍼가 오버플로우 되는 상황을 방지하기 위해 피드백을 주고받는 방법이 Flow Control이다.

> 이와 유사하게, 네트워크 혼잡도가 높아 데이터가 쌓이는 상황을 대비하여 현 네트워크 상황을 지속적으로 유추하여 손실을 피하는 방법이 Congestion Control 이다.



### 6. 아날로그 신호로 변환

- 이렇게 최종적으로 만들어진 A의 전송 데이터는 비트 열이다. 물리 계층에서는 이를 아날로그 신호로 변환하여 전송한다. 또 반대로 수신하는 입장에서는 이런 아날로그 신호를 받아 비트열로 변환한다.



### 7. Routing과 Forwarding

- 드디어 X 라우터에서 A의 데이터를 받았다. 프레임을 읽어 다음 목적지를 선택하는 과정을 Routing이라고 한다. 여러 라우팅 알고리즘을 사용하여 목적지까지의 최적의 루트를 계산하여 경로와 비용을 매핑한 표를 Routing Table, 그리고 입력 포트와 수신 포트를 매핑한 테이블을 Forwarding Table이라고 한다.

> 즉, 최적의 목적지를 계산하고 경로를 결정하는 과정이 Routing, 데이터를 다음 라우터로 이동시키는 과정이 Forwarding 이다.



### 8. 도착, 그 이후

- 위 과정이 반복된다. 최적의 라우터를 결정하여 라우터로 데이터를 전송하고, 다시 이 데이터를 받아 패킷을 분석하여 다음 목적지 결정을 반복하여 D에 도착한다.



- 이후에는 transport layer에서 port 정보를 꺼내 어떤 프로세스에 접근해야 하는지 화인하고, application layer를 지나면서 HTTP 프로토콜에 따라 요청 URL로 변환되어 필요한 데이터를 검색하게 된다.



- 검색된 서버의 데이터는 다시 HTTP 프로토콜을 따라 HTTP 응답 메시지로 변환되고, 위와 반대의 순서로 다시 클라이언트 PC에 전송된다.



- 그 데이터를 PC에서 받아 브라우저에 출력된 결과물이 바로 우리가 웹 사이트를 검색했을 때의 출력물인 것이다.



-출처-

[ecsimsw](www.blog.ecsimsw.com)